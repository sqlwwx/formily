{"version":3,"file":"transform-component.js","sourceRoot":"","sources":["../../../src/__builtins__/shared/transform-component.ts"],"names":[],"mappings":";;;;;;;;;;;AACA,OAAO,EAAE,KAAK,EAAE,MAAM,iBAAiB,CAAA;AACvC,OAAO,EAAE,CAAC,EAAE,MAAM,cAAc,CAAA;AAChC,OAAO,EAAE,MAAM,EAAgB,eAAe,EAAE,MAAM,UAAU,CAAA;AAIhE,MAAM,CAAC,IAAM,kBAAkB,GAAG,UAChC,GAAQ,EACR,cAAwC,EACxC,YAAyB;IAEzB,IAAI,MAAM,EAAE;QACV,OAAO,eAAe,CAAC;YACrB,KAAK,YAAC,KAAK,EAAE,EAA2B;oBAAzB,KAAK,WAAA,EAAE,KAAK,WAAA,EAAE,SAAS,eAAA;gBACpC,OAAO;oBACL,IAAM,IAAI,GAAG;wBACX,KAAK,eACA,KAAK,CACT;wBACD,EAAE,eACG,SAAS,CACb;qBACF,CAAA;oBAED,IAAI,cAAc,EAAE;wBAClB,IAAM,oBAAkB,GAAG,cAAc,CAAA;wBACzC,MAAM,CAAC,IAAI,CAAC,oBAAkB,CAAC,CAAC,OAAO,CAAC,UAAC,OAAO;4BAC9C,IAAI,IAAI,CAAC,EAAE,KAAK,SAAS,EAAE;gCACzB,IAAI,CAAC,EAAE,CAAC,oBAAkB,CAAC,OAAO,CAAC,CAAC,GAAG,SAAS,CAAC,OAAO,CAAC,CAAA;6BAC1D;wBACH,CAAC,CAAC,CAAA;qBACH;oBACD,IAAI,YAAY,EAAE;wBAChB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC,YAAY,EAAE,IAAI,CAAC,KAAK,CAAC,CAAA;qBAC7C;oBAED,OAAO,CAAC,CAAC,GAAG,EAAE,IAAI,EAAE,KAAK,CAAC,CAAA;gBAC5B,CAAC,CAAA;YACH,CAAC;SACF,CAAC,CAAA;KACH;SAAM;QACL,OAAO,eAAe,CAAC;YACrB,KAAK,YAAC,KAAK,EAAE,EAAgB;oBAAd,KAAK,WAAA,EAAE,KAAK,WAAA;gBACzB,OAAO;oBACL,IAAI,IAAI,gBACH,KAAK,CACT,CAAA;oBACD,IAAI,cAAc,EAAE;wBAClB,IAAM,WAAS,GAAG,cAAc,CAAA;wBAChC,MAAM,CAAC,IAAI,CAAC,WAAS,CAAC,CAAC,OAAO,CAAC,UAAC,OAAO;4BACrC,IAAM,KAAK,GAAG,WAAS,CAAC,OAAO,CAAC,CAAA;4BAChC,IAAI,CAAC,YAAK,KAAK,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,SAAG,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAE,CAAC;gCAClD,KAAK,CAAC,YAAK,OAAO,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,SAAG,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAE,CAAC,CAAA;wBAC7D,CAAC,CAAC,CAAA;qBACH;oBACD,IAAI,YAAY,EAAE;wBAChB,IAAI,GAAG,KAAK,CAAC,YAAY,EAAE,IAAI,CAAC,CAAA;qBACjC;oBACD,OAAO,CAAC,CAAC,GAAG,EAAE,IAAI,EAAE,KAAK,CAAC,CAAA;gBAC5B,CAAC,CAAA;YACH,CAAC;SACF,CAAC,CAAA;KACH;AACH,CAAC,CAAA","sourcesContent":["import type { Component } from 'vue'\nimport { merge } from '@formily/shared'\nimport { h } from '@formily/vue'\nimport { isVue2, h as hInVue2, defineComponent } from 'vue-demi'\n\ntype ListenersTransformRules = Record<string, string>\n\nexport const transformComponent = <T extends Record<string, any>>(\n  tag: any,\n  transformRules?: ListenersTransformRules,\n  defaultProps?: Partial<T>\n): Component<T> | any => {\n  if (isVue2) {\n    return defineComponent({\n      setup(props, { attrs, slots, listeners }) {\n        return () => {\n          const data = {\n            attrs: {\n              ...attrs,\n            },\n            on: {\n              ...listeners,\n            },\n          }\n\n          if (transformRules) {\n            const transformListeners = transformRules\n            Object.keys(transformListeners).forEach((extract) => {\n              if (data.on !== undefined) {\n                data.on[transformListeners[extract]] = listeners[extract]\n              }\n            })\n          }\n          if (defaultProps) {\n            data.attrs = merge(defaultProps, data.attrs)\n          }\n\n          return h(tag, data, slots)\n        }\n      },\n    })\n  } else {\n    return defineComponent({\n      setup(props, { attrs, slots }) {\n        return () => {\n          let data = {\n            ...attrs,\n          }\n          if (transformRules) {\n            const listeners = transformRules\n            Object.keys(listeners).forEach((extract) => {\n              const event = listeners[extract]\n              data[`on${event[0].toUpperCase()}${event.slice(1)}`] =\n                attrs[`on${extract[0].toUpperCase()}${extract.slice(1)}`]\n            })\n          }\n          if (defaultProps) {\n            data = merge(defaultProps, data)\n          }\n          return h(tag, data, slots)\n        }\n      },\n    })\n  }\n}\n"]}
{"version":3,"file":"index.js","sourceRoot":"","sources":["../../src/form-layout/index.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  provide,\n  inject,\n  InjectionKey,\n  defineComponent,\n  Ref,\n  ref,\n  watch,\n} from '@vue/composition-api'\nimport { h } from '@formily/vue'\nimport { stylePrefix } from '../__builtins__/configs'\nimport { useResponsiveFormLayout } from './useResponsiveFormLayout'\n\nexport type FormLayoutProps = {\n  className?: string\n  colon?: boolean\n  labelAlign?: 'right' | 'left' | ('right' | 'left')[]\n  wrapperAlign?: 'right' | 'left' | ('right' | 'left')[]\n  labelWrap?: boolean\n  labelWidth?: number\n  wrapperWidth?: number\n  wrapperWrap?: boolean\n  labelCol?: number | number[]\n  wrapperCol?: number | number[]\n  fullness?: boolean\n  size?: 'small' | 'default' | 'large'\n  layout?:\n    | 'vertical'\n    | 'horizontal'\n    | 'inline'\n    | ('vertical' | 'horizontal' | 'inline')[]\n  direction?: 'rtl' | 'ltr'\n  shallow?: boolean\n  feedbackLayout?: 'loose' | 'terse' | 'popover'\n  tooltipLayout?: 'icon' | 'text'\n  bordered?: boolean\n  breakpoints?: number[]\n  inset?: boolean\n  spaceGap?: number\n  gridColumnGap?: number\n  gridRowGap?: number\n}\n\nexport const FormLayoutDeepContext: InjectionKey<Ref<FormLayoutProps>> = Symbol(\n  'FormLayoutDeepContext'\n)\n\nexport const FormLayoutShallowContext: InjectionKey<Ref<FormLayoutProps>> =\n  Symbol('FormLayoutShallowContext')\n\nexport const useFormDeepLayout = (): Ref<FormLayoutProps> =>\n  inject(FormLayoutDeepContext, ref({}))\n\nexport const useFormShallowLayout = (): Ref<FormLayoutProps> =>\n  inject(FormLayoutShallowContext, ref({}))\n\nexport const useFormLayout = (): Ref<FormLayoutProps> => {\n  const shallowLayout = useFormShallowLayout()\n  const deepLayout = useFormDeepLayout()\n  const formLayout = ref({\n    ...deepLayout.value,\n    ...shallowLayout.value,\n  })\n\n  watch(\n    [shallowLayout, deepLayout],\n    () => {\n      formLayout.value = {\n        ...deepLayout.value,\n        ...shallowLayout.value,\n      }\n    },\n    {\n      deep: true,\n    }\n  )\n  return formLayout\n}\n\nexport const FormLayout = defineComponent<FormLayoutProps>({\n  name: 'FFormLayout',\n  props: {\n    className: {},\n    colon: { default: true },\n    labelAlign: {},\n    wrapperAlign: {},\n    labelWrap: { default: false },\n    labelWidth: {},\n    wrapperWidth: {},\n    wrapperWrap: { default: false },\n    labelCol: {},\n    wrapperCol: {},\n    fullness: { default: false },\n    size: { default: 'default' },\n    layout: { default: 'horizontal' },\n    direction: { default: 'ltr' },\n    shallow: { default: true },\n    feedbackLayout: {},\n    tooltipLayout: {},\n    bordered: { default: true },\n    inset: { default: false },\n    breakpoints: {},\n    spaceGap: {},\n    gridColumnGap: {},\n    gridRowGap: {},\n  },\n  setup(customProps, { slots, refs }) {\n    const { props } = useResponsiveFormLayout(customProps, refs)\n\n    const deepLayout = useFormDeepLayout()\n    const newDeepLayout = ref({\n      ...deepLayout,\n    })\n    const shallowProps = ref({})\n\n    watch(\n      [props, deepLayout],\n      () => {\n        shallowProps.value = props.value.shallow ? props.value : undefined\n        if (!props.value.shallow) {\n          Object.assign(newDeepLayout.value, props.value)\n        } else {\n          if (props.value.size) {\n            newDeepLayout.value.size = props.value.size\n          }\n          if (props.value.colon) {\n            newDeepLayout.value.colon = props.value.colon\n          }\n        }\n      },\n      { deep: true, immediate: true }\n    )\n\n    provide(FormLayoutDeepContext, newDeepLayout)\n    provide(FormLayoutShallowContext, shallowProps)\n\n    const formPrefixCls = `${stylePrefix}-form`\n    return () => {\n      const classNames = {\n        [`${formPrefixCls}-${props.value.layout}`]: true,\n        [`${formPrefixCls}-rtl`]: props.value.direction === 'rtl',\n        [`${formPrefixCls}-${props.value.size}`]:\n          props.value.size !== undefined,\n        [`${props.value.className}`]: props.value.className !== undefined,\n      }\n      return h(\n        'div',\n        {\n          ref: 'root',\n          class: classNames,\n        },\n        slots\n      )\n    }\n  },\n})\n\nexport default FormLayout\n"]}
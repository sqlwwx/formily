{"version":3,"file":"index.js","sourceRoot":"","sources":["../../src/array-base/index.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  defineComponent,\n  provide,\n  InjectionKey,\n  Ref,\n  inject,\n  toRefs,\n  ref,\n  onBeforeUnmount,\n  PropType,\n} from '@vue/composition-api'\nimport { Fragment, useField, useFieldSchema, h } from '@formily/vue'\nimport { isValid, uid, clone } from '@formily/shared'\nimport { ArrayField } from '@formily/core'\nimport { stylePrefix } from '../__builtins__/configs'\n\nimport type { Button as ButtonProps } from 'element-ui'\nimport { Button } from 'element-ui'\nimport type { Schema } from '@formily/json-schema'\nimport { HandleDirective } from 'vue-slicksort'\nimport { composeExport } from '../__builtins__/shared'\n\nexport interface IArrayBaseAdditionProps extends ButtonProps {\n  title?: string\n  method?: 'push' | 'unshift'\n  defaultValue?: any\n}\n\nexport type ArrayBaseMixins = {\n  Addition?: typeof ArrayBaseAddition\n  Remove?: typeof ArrayBaseRemove\n  MoveUp?: typeof ArrayBaseMoveUp\n  MoveDown?: typeof ArrayBaseMoveDown\n  SortHandle?: typeof ArrayBaseSortHandle\n  Index?: typeof ArrayBaseIndex\n  useArray?: typeof useArray\n  useIndex?: typeof useIndex\n  useRecord?: typeof useRecord\n}\n\nexport interface IArrayBaseProps {\n  disabled?: boolean\n  keyMap?: WeakMap<Object, String> | String[] | null\n}\n\nexport interface IArrayBaseItemProps {\n  index: number\n  record: any\n}\n\nexport interface IArrayBaseContext {\n  field: Ref<ArrayField>\n  schema: Ref<Schema>\n  props: IArrayBaseProps\n  listeners: {\n    [key in string]?: Function\n  }\n  keyMap?: WeakMap<Object, String> | String[] | null\n}\n\nconst ArrayBaseSymbol: InjectionKey<IArrayBaseContext> =\n  Symbol('ArrayBaseContext')\nconst ItemSymbol: InjectionKey<IArrayBaseItemProps> = Symbol('ItemContext')\n\nconst useArray = () => {\n  return inject(ArrayBaseSymbol, null)\n}\n\nconst useIndex = (index?: number) => {\n  const { index: indexRef } = toRefs(inject(ItemSymbol))\n  return indexRef ?? ref(index)\n}\n\nconst useRecord = (record?: number) => {\n  const { record: recordRef } = toRefs(inject(ItemSymbol))\n  return recordRef ?? ref(record)\n}\n\nconst isObjectValue = (schema: Schema) => {\n  if (Array.isArray(schema?.items)) return isObjectValue(schema.items[0])\n\n  if (schema?.items?.type === 'array' || schema?.items?.type === 'object') {\n    return true\n  }\n  return false\n}\n\nconst useKey = (schema: Schema) => {\n  const isObject = isObjectValue(schema)\n  let keyMap: WeakMap<Object, String> | String[] | null = null\n\n  if (isObject) {\n    keyMap = new WeakMap()\n  } else {\n    keyMap = []\n  }\n\n  onBeforeUnmount(() => {\n    keyMap = null\n  })\n\n  return {\n    keyMap,\n    getKey: (record: any, index?: number) => {\n      if (keyMap instanceof WeakMap) {\n        if (!keyMap.has(record)) {\n          keyMap.set(record, uid())\n        }\n        return `${keyMap.get(record)}-${index}`\n      }\n\n      if (!keyMap[index]) {\n        keyMap[index] = uid()\n      }\n\n      return `${keyMap[index]}-${index}`\n    },\n  }\n}\n\nconst getDefaultValue = (defaultValue: any, schema: Schema): any => {\n  if (isValid(defaultValue)) return clone(defaultValue)\n  if (Array.isArray(schema?.items))\n    return getDefaultValue(defaultValue, schema.items[0])\n  if (schema?.items?.type === 'array') return []\n  if (schema?.items?.type === 'boolean') return true\n  if (schema?.items?.type === 'date') return ''\n  if (schema?.items?.type === 'datetime') return ''\n  if (schema?.items?.type === 'number') return 0\n  if (schema?.items?.type === 'object') return {}\n  if (schema?.items?.type === 'string') return ''\n  return null\n}\n\nconst ArrayBaseInner = defineComponent<IArrayBaseProps>({\n  name: 'ArrayBase',\n  props: {\n    disabled: {\n      type: Boolean,\n      default: false,\n    },\n    keyMap: {\n      type: [WeakMap, Array] as PropType<WeakMap<Object, String> | String[]>,\n    },\n  },\n  setup(props, { slots, listeners }) {\n    const field = useField<ArrayField>()\n    const schema = useFieldSchema()\n\n    provide(ArrayBaseSymbol, {\n      field,\n      schema,\n      props,\n      listeners,\n      keyMap: props.keyMap,\n    })\n    return () => {\n      return h(Fragment, {}, slots)\n    }\n  },\n})\n\nconst ArrayBaseItem = defineComponent({\n  name: 'ArrayBaseItem',\n  props: ['index', 'record'],\n  setup(props: IArrayBaseItemProps, { slots }) {\n    provide(ItemSymbol, props)\n    return () => {\n      return h(Fragment, {}, slots)\n    }\n  },\n})\n\nconst ArrayBaseSortHandle = defineComponent({\n  name: 'ArrayBaseSortHandle',\n  props: ['index'],\n  directives: {\n    handle: HandleDirective,\n  },\n  setup(props, { attrs }) {\n    const array = useArray()\n    const prefixCls = `${stylePrefix}-array-base`\n\n    return () => {\n      if (!array) return null\n      if (array.field.value?.pattern !== 'editable') return null\n\n      return h(\n        Button,\n        {\n          directives: [{ name: 'handle' }],\n          class: [`${prefixCls}-sort-handle`],\n          attrs: {\n            size: 'mini',\n            type: 'text',\n            icon: 'el-icon-rank',\n            ...attrs,\n          },\n        },\n        {}\n      )\n    }\n  },\n})\n\nconst ArrayBaseIndex = defineComponent({\n  name: 'ArrayBaseIndex',\n  setup(props, { attrs }) {\n    const index = useIndex()\n    const prefixCls = `${stylePrefix}-array-base`\n    return () => {\n      return h(\n        'span',\n        {\n          class: `${prefixCls}-index`,\n          attrs,\n        },\n        {\n          default: () => [`#${index.value + 1}.`],\n        }\n      )\n    }\n  },\n})\n\nconst ArrayBaseAddition = defineComponent({\n  name: 'ArrayBaseAddition',\n  props: ['title', 'method', 'defaultValue'],\n  setup(props: IArrayBaseAdditionProps, { listeners }) {\n    const self = useField()\n    const array = useArray()\n    const prefixCls = `${stylePrefix}-array-base`\n    return () => {\n      if (!array) return null\n      if (array?.field.value.pattern !== 'editable') return null\n      return h(\n        Button,\n        {\n          class: `${prefixCls}-addition`,\n          attrs: {\n            type: 'ghost',\n            icon: 'qax-icon-Alone-Plus',\n            ...props,\n          },\n          on: {\n            ...listeners,\n            click: (e) => {\n              if (array.props?.disabled) return\n              const defaultValue = getDefaultValue(\n                props.defaultValue,\n                array?.schema.value\n              )\n              if (props.method === 'unshift') {\n                array?.field?.value.unshift(defaultValue)\n                array.listeners?.add?.(0)\n              } else {\n                array?.field?.value.push(defaultValue)\n                array.listeners?.add?.(array?.field?.value?.value?.length - 1)\n              }\n              if (listeners.click) {\n                listeners.click(e)\n              }\n            },\n          },\n        },\n        {\n          default: () => [self.value.title || props.title],\n        }\n      )\n    }\n  },\n})\n\nconst ArrayBaseRemove = defineComponent<\n  ButtonProps & { title?: string; index?: number }\n>({\n  name: 'ArrayBaseRemove',\n  props: ['title', 'index'],\n  setup(props, { attrs, listeners }) {\n    const indexRef = useIndex(props.index)\n    const base = useArray()\n    const prefixCls = `${stylePrefix}-array-base`\n    return () => {\n      if (base?.field.value.pattern !== 'editable') return null\n      return h(\n        Button,\n        {\n          class: `${prefixCls}-remove`,\n          attrs: {\n            type: 'text',\n            size: 'mini',\n            icon: 'el-icon-delete',\n            ...attrs,\n          },\n          on: {\n            ...listeners,\n            click: (e: MouseEvent) => {\n              e.stopPropagation()\n              if (Array.isArray(base?.keyMap)) {\n                base?.keyMap?.splice(indexRef.value, 1)\n              }\n\n              base?.field.value.remove(indexRef.value as number)\n              base?.listeners?.remove?.(indexRef.value as number)\n\n              if (listeners.click) {\n                listeners.click(e)\n              }\n            },\n          },\n        },\n        {\n          default: () => [props.title],\n        }\n      )\n    }\n  },\n})\n\nconst ArrayBaseMoveDown = defineComponent<\n  ButtonProps & { title?: string; index?: number }\n>({\n  name: 'ArrayBaseMoveDown',\n  props: ['title', 'index'],\n  setup(props, { attrs, listeners }) {\n    const indexRef = useIndex(props.index)\n    const base = useArray()\n    const prefixCls = `${stylePrefix}-array-base`\n    return () => {\n      if (base?.field.value.pattern !== 'editable') return null\n      return h(\n        Button,\n        {\n          class: `${prefixCls}-move-down`,\n          attrs: {\n            size: 'mini',\n            type: 'text',\n            icon: 'el-icon-arrow-down',\n            ...attrs,\n          },\n          on: {\n            ...listeners,\n            click: (e: MouseEvent) => {\n              e.stopPropagation()\n              if (Array.isArray(base?.keyMap)) {\n                base.keyMap.splice(\n                  indexRef.value + 1,\n                  0,\n                  base.keyMap.splice(indexRef.value, 1)[0]\n                )\n              }\n\n              base?.field.value.moveDown(indexRef.value as number)\n              base?.listeners?.moveDown?.(indexRef.value as number)\n\n              if (listeners.click) {\n                listeners.click(e)\n              }\n            },\n          },\n        },\n        {\n          default: () => [props.title],\n        }\n      )\n    }\n  },\n})\n\nconst ArrayBaseMoveUp = defineComponent<\n  ButtonProps & { title?: string; index?: number }\n>({\n  name: 'ArrayBaseMoveUp',\n  props: ['title', 'index'],\n  setup(props, { attrs, listeners }) {\n    const indexRef = useIndex(props.index)\n    const base = useArray()\n    const prefixCls = `${stylePrefix}-array-base`\n    return () => {\n      if (base?.field.value.pattern !== 'editable') return null\n      return h(\n        Button,\n        {\n          class: `${prefixCls}-move-up`,\n          attrs: {\n            size: 'mini',\n            type: 'text',\n            icon: 'el-icon-arrow-up',\n            ...attrs,\n          },\n          on: {\n            ...listeners,\n            click: (e: MouseEvent) => {\n              e.stopPropagation()\n              if (Array.isArray(base?.keyMap)) {\n                base.keyMap.splice(\n                  indexRef.value - 1,\n                  0,\n                  base.keyMap.splice(indexRef.value, 1)[0]\n                )\n              }\n\n              base?.field.value.moveUp(indexRef.value as number)\n              base?.listeners?.moveUp?.(indexRef.value as number)\n\n              if (listeners.click) {\n                listeners.click(e)\n              }\n            },\n          },\n        },\n        {\n          default: () => [props.title],\n        }\n      )\n    }\n  },\n})\n\nexport const ArrayBase = composeExport(ArrayBaseInner, {\n  Index: ArrayBaseIndex,\n  Item: ArrayBaseItem,\n  SortHandle: ArrayBaseSortHandle,\n  Addition: ArrayBaseAddition,\n  Remove: ArrayBaseRemove,\n  MoveDown: ArrayBaseMoveDown,\n  MoveUp: ArrayBaseMoveUp,\n  useArray: useArray,\n  useIndex: useIndex,\n  useKey: useKey,\n  useRecord: useRecord,\n})\n"]}
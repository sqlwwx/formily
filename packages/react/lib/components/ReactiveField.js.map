{"version":3,"file":"ReactiveField.js","sourceRoot":"","sources":["../../src/components/ReactiveField.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { Fragment, useContext } from 'react'\nimport { toJS } from '@formily/reactive'\nimport { observer } from '@formily/reactive-react'\nimport { isFn, FormPath } from '@formily/shared'\nimport { isVoidField, GeneralField, Form } from '@formily/core'\nimport { SchemaOptionsContext } from '../shared'\ninterface IReactiveFieldProps {\n  field: GeneralField\n  children?:\n    | ((field: GeneralField, form: Form) => React.ReactChild)\n    | React.ReactNode\n}\n\nconst mergeChildren = (children: React.ReactNode, content: React.ReactNode) => {\n  if (!children && !content) return\n  return (\n    <Fragment>\n      {children}\n      {content}\n    </Fragment>\n  )\n}\n\nconst renderChildren = (children: React.ReactNode, ...args: any[]) =>\n  isFn(children) ? children(...args) : children\n\nconst ReactiveInternal: React.FC<IReactiveFieldProps> = (props) => {\n  const options = useContext(SchemaOptionsContext)\n  if (!props.field) {\n    return <Fragment>{renderChildren(props.children)}</Fragment>\n  }\n  const field = props.field\n  const content = mergeChildren(\n    renderChildren(props.children, field, field.form),\n    field.content ?? field.component[1].children\n  )\n  if (field.display !== 'visible') return null\n\n  const renderDecorator = (children: React.ReactNode) => {\n    if (!field.decorator[0]) {\n      return <Fragment>{children}</Fragment>\n    }\n    const finalComponent =\n      FormPath.getIn(options?.components, field.decorator[0]) ??\n      field.decorator[0]\n\n    return React.createElement(\n      finalComponent,\n      toJS(field.decorator[1]),\n      children\n    )\n  }\n\n  const renderComponent = () => {\n    if (!field.component[0]) return content\n    const value = !isVoidField(field) ? field.value : undefined\n    const onChange = !isVoidField(field)\n      ? (...args: any[]) => {\n          field.onInput(...args)\n          field.component[1]?.onChange?.(...args)\n        }\n      : field.component[1]?.onChange\n    const onFocus = !isVoidField(field)\n      ? (...args: any[]) => {\n          field.onFocus(...args)\n          field.component[1]?.onFocus?.(...args)\n        }\n      : field.component[1]?.onFocus\n    const onBlur = !isVoidField(field)\n      ? (...args: any[]) => {\n          field.onBlur(...args)\n          field.component[1]?.onBlur?.(...args)\n        }\n      : field.component[1]?.onBlur\n    const disabled = !isVoidField(field)\n      ? field.pattern === 'disabled' || field.pattern === 'readPretty'\n      : undefined\n    const readOnly = !isVoidField(field)\n      ? field.pattern === 'readOnly'\n      : undefined\n    const finalComponent =\n      FormPath.getIn(options?.components, field.component[0]) ??\n      field.component[0]\n    return React.createElement(\n      finalComponent,\n      {\n        disabled,\n        readOnly,\n        ...toJS(field.component[1]),\n        value,\n        onChange,\n        onFocus,\n        onBlur,\n      },\n      content\n    )\n  }\n\n  return renderDecorator(renderComponent())\n}\n\nReactiveInternal.displayName = 'ReactiveField'\n\nexport const ReactiveField = observer(ReactiveInternal, {\n  forwardRef: true,\n})\n"]}